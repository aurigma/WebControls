Type.registerNamespace("Aurigma.GraphicsMill.AjaxControls"),Aurigma.GraphicsMill.AjaxControls.VObjectsRubberband=function(n){Aurigma.GraphicsMill.AjaxControls.VObjectsRubberband.initializeBase(this,[n]),this._canvasId,this._rectangleChangingDelegate,this._mouseDownDelegate,this._mouseMoveDelegate,this._mouseUpDelegate,this._zoomDelegate,this._canvasSaveStateDelegate,this._bitmapViewerSaveStateDelegate,this._hostDoc},Aurigma.GraphicsMill.AjaxControls.VObjectsRubberband.prototype={get_canvasID:function(){return this._canvasID},set_canvasID:function(n){this._canvasID=n},connect:function(n){var u,t,r,f,i,e;Aurigma.GraphicsMill.AjaxControls.VObjectsRubberband.callBaseMethod(this,"connect",[n]),this._hostDoc=this._viewer.get_frameDoc(),u=this._getRenderCtx(),t=$find(this.get_canvasID()),this._canvasSaveStateDelegate||(this._canvasSaveStateDelegate=Function.createDelegate(t,t._saveState)),this._viewer.add_invokingCallbackRequest(this._canvasSaveStateDelegate),this._bitmapViewerSaveStateDelegate||(this._bitmapViewerSaveStateDelegate=Function.createDelegate(this._viewer,this._viewer._saveState)),t.add_invokingCallbackRequest(this._bitmapViewerSaveStateDelegate),f=function(){if(t.get_status()==Aurigma.GraphicsMill.AjaxControls.VectorObjects.UpdateStatus.ready&&t.get_isInitialized()){t.remove_statusChanged(r),t.remove_initialized(r),r=null;var n=this._viewer;t._screenXDpi=n.get_screenXDpi(),t._screenYDpi=n.get_screenYDpi(),t.set_workspaceWidth(n.get_workspaceWidth()),t.set_workspaceHeight(n.get_workspaceHeight()),t.set_zoom(n.get_zoom()),t._addElement(u),t.redraw(!0)}},t.get_status()==Aurigma.GraphicsMill.AjaxControls.VectorObjects.UpdateStatus.ready&&t.get_isInitialized()?(i=this._viewer,t._screenXDpi=i.get_screenXDpi(),t._screenYDpi=i.get_screenYDpi(),t.set_workspaceWidth(i.get_workspaceWidth()),t.set_workspaceHeight(i.get_workspaceHeight()),t.set_zoom(i.get_zoom()),t._addElement(u),t.redraw(!0)):(r=Function.createDelegate(this,f),t.add_statusChanged(r),t.add_initialized(r)),e=this._viewer,this._mouseDownDelegate=Function.createDelegate(this,function(n,i){this._viewer.get_navigator()==""&&t.raiseMouseDown(i)}),this._viewer.add_workspaceMouseDown(this._mouseDownDelegate),this._mouseMoveDelegate=Function.createDelegate(this,function(n,i){this._viewer.get_navigator()==""&&t.raiseMouseMove(i)}),this._viewer.add_workspaceMouseMove(this._mouseMoveDelegate),this._mouseUpDelegate=Function.createDelegate(this,function(n,i){this._viewer.get_navigator()==""&&t.raiseMouseUp(i)}),this._viewer.add_workspaceMouseUp(this._mouseUpDelegate),this._zoomDelegate=Function.createDelegate(this,this._onZoom),this._viewer.add_zoomed(this._zoomDelegate)},disconnect:function(){var n;Aurigma.GraphicsMill.AjaxControls.VObjectsRubberband.callBaseMethod(this,"disconnect"),n=$find(this.get_canvasID()),this._viewer&&(this._canvasSaveStateDelegate&&(this._viewer.remove_invokingCallbackRequest(this._canvasSaveStateDelegate),this._canvasSaveStateDelegate=null),this._bitmapViewerSaveStateDelegate&&(n=$get(this.get_canvasID()),n&&n.remove_invokingCallbackRequest(this._bitmapViewerSaveStateDelegate),this._bitmapViewerSaveStatedelegate=null),this._hostDoc=null,this._viewer.clearRenderCtx(this._getRenderCtx()),this._mouseUpDelegate&&(this._viewer.remove_workspaceMouseUp(this._mouseUpDelegate),this._mouseUpDelegate=null),this._mouseDownDelegate&&(this._viewer.remove_workspaceMouseDown(this._mouseDownDelegate),this._mouseDownDelegate=null),this._mouseMoveDelegate&&(this._viewer.remove_workspaceMouseMove(this._mouseMoveDelegate),this._mouseMoveDelegate=null),this._zoomDelegate&&(this._viewer.remove_zoomed(this._zoomDelegate),this._zoomDelegate=null))},update:function(){this._onZoom()},_onZoom:function(){var n=$find(this.get_canvasID()),t=this._viewer;n.set_zoom(t.get_zoom()),n._screenXDpi=t.get_screenXDpi(),n._screenYDpi=t.get_screenYDpi(),n.redraw()},_getRenderCtx:function(){return this._viewer.get_rubberbandCtx()},initialize:function(){Aurigma.GraphicsMill.AjaxControls.VObjectsRubberband.callBaseMethod(this,"initialize")},dispose:function(){this._canvasSaveStateDelegate&&(this._viewer.remove_invokingCallbackRequest(this._canvasSaveStateDelegate),this._canvasSaveStateDelegate=null);if(this._bitmapViewerSaveStateDelegate){var n=$find(this.get_canvasID());n&&n.remove_invokingCallbackRequest(this._bitmapViewerSaveStateDelegate),this._bitmapViewerSaveStatedelegate=null}Aurigma.GraphicsMill.AjaxControls.VObjectsRubberband.callBaseMethod(this,"dispose")}},Aurigma.GraphicsMill.AjaxControls.VObjectsRubberband.registerClass("Aurigma.GraphicsMill.AjaxControls.VObjectsRubberband",Aurigma.GraphicsMill.UserInputController);