Type.registerNamespace("Aurigma.GraphicsMill"),Aurigma.GraphicsMill.ResizeMode=function(){throw Error.notImplemented();},Aurigma.GraphicsMill.ResizeMode.prototype={none:0,proportional:1,arbitrary:2},Aurigma.GraphicsMill.ResizeMode.registerEnum("Aurigma.GraphicsMill.ResizeMode"),Aurigma.GraphicsMill.UserInputController=function(n){Aurigma.GraphicsMill.UserInputController.initializeBase(this,[n]),this._viewer=null},Aurigma.GraphicsMill.UserInputController.prototype={connect:function(n){this._viewer=$find(n)},disconnect:function(){this._viewer&&(this._viewer.set_cursor(Aurigma.GraphicsMill.Cursor.defaultCursor),this._viewer=null)},dispose:function(){Aurigma.GraphicsMill.UserInputController.callBaseMethod(this,"dispose"),this.disconnect()}},Aurigma.GraphicsMill.UserInputController.registerClass("Aurigma.GraphicsMill.UserInputController",Sys.UI.Control,Sys.IDisposable),Aurigma.GraphicsMill.ZoomNavigator=function(n){Aurigma.GraphicsMill.ZoomNavigator.initializeBase(this,[n])},Aurigma.GraphicsMill.ZoomNavigator.prototype={_onWorkspaceClick:function(n,t){var i=this._viewer.workspaceToControlPoint(new Aurigma.GraphicsMill.PointF(t.x,t.y)),u,r;i=this._viewer.controlToContentPoint(i),u=this._viewer.get_width(),r=this._viewer.get_height(),this._viewer.set_zoom(this._viewer.get_zoom()*this._zoomK,{skipZoomToCenter:!0}),i.x=Math.round(i.x*this._zoomK-u/2),i.y=Math.round(i.y*this._zoomK-r/2),this._viewer.set_scrollingPosition(i)},connect:function(n){Aurigma.GraphicsMill.ZoomNavigator.callBaseMethod(this,"connect",[n]),this._viewer.set_cursor(this._cursor),this._workspaceClickDelegate=Function.createDelegate(this,this._onWorkspaceClick),this._viewer.add_workspaceClick(this._workspaceClickDelegate)},disconnect:function(){this._viewer&&this._workspaceClickDelegate&&(this._viewer.remove_workspaceClick(this._workspaceClickDelegate),this._workspaceClickDelegate=null),Aurigma.GraphicsMill.ZoomNavigator.callBaseMethod(this,"disconnect")}},Aurigma.GraphicsMill.ZoomNavigator.registerClass("Aurigma.GraphicsMill.ZoomNavigator",Aurigma.GraphicsMill.UserInputController),Aurigma.GraphicsMill.ZoomInNavigator=function(n){Aurigma.GraphicsMill.ZoomInNavigator.initializeBase(this,[n]),this._zoomK=1.5,this._cursor=Aurigma.GraphicsMill.Cursor.zoomIn},Aurigma.GraphicsMill.ZoomInNavigator.registerClass("Aurigma.GraphicsMill.ZoomInNavigator",Aurigma.GraphicsMill.ZoomNavigator),Aurigma.GraphicsMill.ZoomOutNavigator=function(n){Aurigma.GraphicsMill.ZoomOutNavigator.initializeBase(this,[n]),this._zoomK=.667,this._cursor=Aurigma.GraphicsMill.Cursor.zoomOut},Aurigma.GraphicsMill.ZoomOutNavigator.registerClass("Aurigma.GraphicsMill.ZoomOutNavigator",Aurigma.GraphicsMill.ZoomNavigator),Aurigma.GraphicsMill.PanNavigator=function(n){Aurigma.GraphicsMill.PanNavigator.initializeBase(this,[n]),this._panned=!1},Aurigma.GraphicsMill.PanNavigator.prototype={_onMouseDown:function(n,t){var i;this._prevPoint=this._viewer.workspaceToControlPoint(new Aurigma.GraphicsMill.PointF(t.x,t.y)),this._panned==!0&&(i=this._viewer.get_contentCtx(),i.releaseCapture&&i.releaseCapture()),this._panned==!1&&(this._panned=!0,this._startScroll=this._viewer.get_scrollingPosition(),this._startPoint={x:t.clientX,y:t.clientY},this._mouseMoveDelegate||(this._mouseMoveDelegate=Function.createDelegate(this,this._onMouseMove)),this._viewer.add_workspaceMouseMove(this._mouseMoveDelegate),navigator.userAgent.toLowerCase().indexOf("webkit")==-1&&this._viewer.set_cursor(Aurigma.GraphicsMill.Cursor.move),(i=this._viewer.get_contentCtx())&&i.setCapture&&i.setCapture()),t.preventDefault&&t.preventDefault()},_onMouseMove:function(n,t){if(this._panned){var i={};i.x=this._startScroll.x+(this._startPoint.x-t.clientX),i.y=this._startScroll.y+(this._startPoint.y-t.clientY),this._viewer.set_scrollingPosition(i)}t.preventDefault&&t.preventDefault(),t.stopPropagation&&t.stopPropagation()},_onMouseUp:function(){this._viewer.set_cursor(Aurigma.GraphicsMill.Cursor.pan);if(this._panned){this._panned=!1,this._viewer.remove_workspaceMouseMove(this._mouseMoveDelegate);var i;(i=this._viewer.get_contentCtx())&&i.releaseCapture&&i.releaseCapture()}},connect:function(n){Aurigma.GraphicsMill.PanNavigator.callBaseMethod(this,"connect",[n]),this._viewer.set_cursor(Aurigma.GraphicsMill.Cursor.pan),this._mouseDownDelegate=Function.createDelegate(this,this._onMouseDown),this._viewer.add_workspaceMouseDown(this._mouseDownDelegate),this._mouseUpDelegate=Function.createDelegate(this,this._onMouseUp),this._viewer.add_workspaceMouseUp(this._mouseUpDelegate)},disconnect:function(){this._viewer&&(this._mouseDownDelegate&&(this._viewer.remove_workspaceMouseDown(this._mouseDownDelegate),this._mouseDownDelegate=null),this._mouseMoveDelegate&&(this._viewer.remove_workspaceMouseMove(this._mouseMoveDelegate),this._mouseMoveDelegate=null),this._mouseUpDelegate&&(this._viewer.remove_workspaceMouseUp(this._mouseUpDelegate),this._mouseUpDelegate=null)),Aurigma.GraphicsMill.PanNavigator.callBaseMethod(this,"disconnect")}},Aurigma.GraphicsMill.PanNavigator.registerClass("Aurigma.GraphicsMill.PanNavigator",Aurigma.GraphicsMill.UserInputController),Aurigma.GraphicsMill.RectangleController=function(n){Aurigma.GraphicsMill.RectangleController.initializeBase(this,[n]),this._gripBorderWidth=1,this._outlineWidth=1,this._stateFieldId="",this._maskColorRed=0,this._maskColorGreen=0,this._maskColorBlue=0,this._maskOpacity=50,this._cursors={TL:Aurigma.GraphicsMill.Cursor.sizeNW,TR:Aurigma.GraphicsMill.Cursor.sizeNE,BL:Aurigma.GraphicsMill.Cursor.sizeSW,BR:Aurigma.GraphicsMill.Cursor.sizeSE,T:Aurigma.GraphicsMill.Cursor.sizeN,B:Aurigma.GraphicsMill.Cursor.sizeS,L:Aurigma.GraphicsMill.Cursor.sizeW,R:Aurigma.GraphicsMill.Cursor.sizeE,inside:Aurigma.GraphicsMill.Cursor.move},this._draggedControl=null,this._prevOffset=null,this._handleInput=!0,this._totalMaskingTimer=null},Aurigma.GraphicsMill.RectangleController.prototype={_erase:function(){this.set_p_rectangle(new Aurigma.GraphicsMill.Rectangle(0,0,-1,-1))},_createRect:function(n,t,i){var u=document.createElement("div"),r=u.style;return i!=null&&(r.backgroundColor=i),r.position="absolute",r.zIndex=1e3,r.width=n+"px",r.height=t+"px",u.ondrag=function(){return!1},u.unselectable="on",u},_createGrip:function(n){var i=this.get_p_gripSize(),t=this._createRect(i,i,"rgb(42, 240, 58)");return this._viewer._jquery(t).css({display:n?"block":"none",opacity:"0.5",border:this._gripBorderWidth+"px #EEE solid"}),t},_createMask:function(){var n=this._createRect(1,1,null);return this._viewer._jquery(n).css({top:"0px",left:"0px","border-color":String.format("rgba({0},{1},{2},{3})",this._maskColorRed,this._maskColorGreen,this._maskColorBlue,parseFloat(this._maskOpacity)/100),"border-style":"solid","-webkit-transform":"translate3d(0,0,0)","-moz-transform":"translate3d(0,0,0)",visibility:"hidden"}),n},_createIE68Mask:function(){var t=document.createElement("div"),n=t.style;return n.fontSize="0px",n.position="absolute",n.backgroundColor=String.format("rgb({0},{1},{2})",this._maskColorRed,this._maskColorGreen,this._maskColorBlue),n.filter="alpha(opacity="+this._maskOpacity.toString()+")",n.opacity=(this._maskOpacity/100).toString(),t.ondrag=function(){return!1},t.unselectable="on",t},_delayedMasking:function(n){this._totalMaskingTimer&&clearTimeout(this._totalMaskingTimer),this._totalMaskingTimer=setTimeout(n,150)},_hideMask:function(){Sys.Browser.agent===Sys.Browser.InternetExplorer&&(Sys.Browser.version<9||Sys.Browser.documentMode<9)||Aurigma.GraphicsMill.Utils.Platform.IsNativeAndroidBrowser()?this._topMask.style.display=this._bottomMask.style.display=this._leftMask.style.display=this._rightMask.style.display="none":this._viewer._jquery(this._mask).css("visibility","hidden")},_update:function(n){var w;if(!this._viewer)return;var r=this.get_p_rectangle(),nt=this.get_p_resizeMode(),u=new Aurigma.GraphicsMill.Rectangle(0,0,this._viewer.get_workspaceWidth(),this._viewer.get_workspaceHeight()).intersect(r);this.get_p_resizeMode()==Aurigma.GraphicsMill.ResizeMode.proportional&&(u.width*this.get_p_ratio()>u.height&&(u.width=u.height/this.get_p_ratio()),u.height/this.get_p_ratio()>u.width&&(u.height=this.get_p_ratio()*u.width)),this.set_p_rectangle(u.round()),r=this.get_p_rectangle();var b=this.get_p_gripsVisible(),a=r.width>=0&&r.height>=0,it=a?"block":"none";this._rect.style.display=it,n&&!this._draggedControl&&(w=a&&b&&nt!=Aurigma.GraphicsMill.ResizeMode.none?"block":"none",this._topLeftGrip.style.display=this._topRightGrip.style.display=this._bottomLeftGrip.style.display=this._bottomRightGrip.style.display=w,this._leftGrip.style.display=this._rightGrip.style.display=this._topGrip.style.display=this._bottomGrip.style.display=w,a&&!this.get_p_maskVisible()&&this._hideMask());if(!a)return;var t=this._viewer.workspaceToContentPoint(new Sys.UI.Point(r.x,r.y)),i=this._viewer.workspaceToContentPoint(new Sys.UI.Point(r.x+r.width,r.y+r.height)),c=this._viewer.workspaceToContentPoint(new Sys.UI.Point(this._viewer.get_workspaceWidth(),this._viewer.get_workspaceHeight())),g=this.get_outlineWidth(),f=this._rect.style,p=Math.max(i.x-t.x,0),y=Math.max(i.y-t.y,0);f.width=p+"px",f.height=y+"px",f.display="block",f.left=t.x+"px",f.top=t.y+"px";if(b&&(!Aurigma.GraphicsMill.Utils.Platform.IsAndroid()||Aurigma.GraphicsMill.Utils.Platform.IsAndroid()&&n)){var l=this.get_p_gripSize()+this._gripBorderWidth*2,d=Math.round(l/2),v=Math.max(Math.floor((l-g)/2),0),tt=t.x-v,rt=t.y-v,ft=i.x-l+v,ut=i.y-l+v,k=new Sys.UI.Point(Math.round((t.x+i.x)/2),Math.round((t.y+i.y)/2));this._jLeftGrips.css("left",tt+"px"),this._jTopGrips.css("top",rt+"px"),this._jRightGrips.css("left",ft+"px"),this._jBottomGrips.css("top",ut+"px"),this._jHorizCenterGrips.css("top",k.y-d+"px"),this._jVertCenterGrips.css("left",k.x-d+"px")}if(n)if(this.get_p_maskVisible())if(Sys.Browser.agent===Sys.Browser.InternetExplorer&&(Sys.Browser.version<9||Sys.Browser.documentMode<9)||Aurigma.GraphicsMill.Utils.Platform.IsNativeAndroidBrowser()){var s=this._topMask.style,e=this._bottomMask.style,o=this._leftMask.style,h=this._rightMask.style;s.left=e.left=o.left=s.top="0px",s.width=e.width=c.x+"px",s.height=t.y+"px",e.top=i.y+"px",e.height=c.y-i.y+"px",o.top=h.top=t.y+"px",o.width=t.x+"px",o.height=h.height=i.y-t.y+"px",h.left=i.x+"px",h.width=c.x-i.x+"px",s.display=t.y>0?"block":"none",e.display=c.y>i.y?"block":"none",o.display=t.x>0?"block":"none",h.display=c.x>i.x?"block":"none"}else this._viewer._jquery(this._mask).css({left:"0px",top:"0px",width:p,height:y,"border-left-width":t.x+"px","border-top-width":t.y+"px","border-right-width":this._viewer._contentCtxDimension.width-(t.x+p)+"px","border-bottom-width":this._viewer._contentCtxDimension.height-(t.y+y)+"px",visibility:"visible"})},_changeCursor:function(n){var t=this._cursors[n];t==undefined&&(t=Aurigma.GraphicsMill.Cursor.defaultCursor),this._viewer.set_cursor(t)},_hitTest:function(n,t){var i=this._viewer.workspaceToContentPoint(n),it=this.get_p_resizeMode(),e=this.get_p_rectangle(),s,o,h,c,b,k;isNaN(t)&&(t=this.get_p_gripSize());var r=t/2,f=this._viewer.workspaceToContentPoint(new Sys.UI.Point(e.x,e.y)),u=this._viewer.workspaceToContentPoint(new Sys.UI.Point(e.x+e.width,e.y+e.height)),w=i.x>=f.x,nt=i.x<=u.x,g=i.y>=f.y,d=i.y<=u.y;if(it!=Aurigma.GraphicsMill.ResizeMode.none){var y=i.x>=f.x-r,p=i.x<=f.x+r,l=i.y>=f.y-r,a=i.y<=f.y+r;if(y&&p&&l&&a)return"TL";s=i.x>=u.x-r,o=i.x<=u.x+r;if(s&&o&&l&&a)return"TR";h=i.y>=u.y-r,c=i.y<=u.y+r;if(y&&p&&h&&c)return"BL";if(s&&o&&h&&c)return"BR";if(it==Aurigma.GraphicsMill.ResizeMode.arbitrary)if(this.get_p_gripsVisible()){var v=new Sys.UI.Point(Math.round((f.x+u.x)/2),Math.round((f.y+u.y)/2)),tt=i.x>=v.x-r,rt=i.x<=v.x+r;if(tt&&rt&&l&&a)return"T";if(tt&&rt&&h&&c)return"B";b=i.y>=v.y-r,k=i.y<=v.y+r;if(y&&p&&b&&k)return"L";if(s&&o&&b&&k)return"R"}else{if(w&&nt&&l&&a)return"T";if(w&&nt&&h&&c)return"B";if(y&&p&&g&&d)return"L";if(s&&o&&g&&d)return"R"}}return this.get_p_movable()&&w&&nt&&g&&d?"inside":null},_onWorkspaceMouseDown:function(n,t){var r,i;Aurigma.GraphicsMill.Utils.Platform.IsTouchIE()&&(this._panningData.initialEvent=t,this._panningData.initialCurrentLeft=this._viewer._jHolderElement.scrollLeft(),this._panningData.initialCurrentTop=this._viewer._jHolderElement.scrollTop());if(!this._handleInput)return;this._startOffset=this._viewer.workspaceToContentPoint(new Aurigma.GraphicsMill.PointF(t.x,t.y)),this._draggedControl&&this._viewer.get_contentCtx().releaseCapture&&this._viewer.get_contentCtx().releaseCapture(),r=!1,Aurigma.GraphicsMill.Utils.Platform.IsTouchIE()?r=!(t.originalEvent.pointerType==t.originalEvent.MSPOINTER_TYPE_MOUSE):Aurigma.GraphicsMill.Utils.Platform.IsTouchDevice()&&(r=!0),this._draggedControl=r?this._hitTest(new Aurigma.GraphicsMill.PointF(t.x,t.y),this.get_p_touchHideGripSize()):this._hitTest(new Aurigma.GraphicsMill.PointF(t.x,t.y));if(this.get_p_erasable()&&!this._draggedControl){this._viewer.set_cursor(Aurigma.GraphicsMill.Cursor.cross),this._draggedControl="BR",this._startRectangle=new Aurigma.GraphicsMill.Rectangle(Math.round(t.x),Math.round(t.y),0,0),this._update(!1);return}this._changeCursor(this._draggedControl),i=this.get_p_rectangle();switch(this._draggedControl){case"TL":i.y=i.y+i.height,i.height=-i.height,i.x=i.x+i.width,i.width=-i.width;break;case"T":case"TR":i.y=i.y+i.height,i.height=-i.height;break;case"L":case"BL":i.x=i.x+i.width,i.width=-i.width}this._startRectangle=i,this._draggedControl&&t.preventDefault&&t.preventDefault()},_onWorkspaceMouseMove:function(n,t){var u,l,g,v,r,f,s,h,b,w;if(!this._handleInput)return;u=new Aurigma.GraphicsMill.PointF(t.x,t.y),l=this._viewer.workspaceToContentPoint(u);if(this._draggedControl){this.get_p_maskVisible()&&this._hideMask(),this.get_p_gripsVisible()&&Aurigma.GraphicsMill.Utils.Platform.IsAndroid()&&(this._topLeftGrip.style.display=this._topRightGrip.style.display=this._bottomLeftGrip.style.display=this._bottomRightGrip.style.display=this._leftGrip.style.display=this._rightGrip.style.display=this._topGrip.style.display=this._bottomGrip.style.display="none");var i=this._startRectangle.clone(),y=this._viewer.get_workspaceWidth(),a=this._viewer.get_workspaceHeight();if(this._draggedControl=="inside")g=this._viewer.contentToControlPoint(new Sys.UI.Point(l.x-this._startOffset.x,l.y-this._startOffset.y)),v=this._viewer.controlToWorkspacePoint(g),i.x=Math.min(Math.max(i.x+=v.x,0),y-i.width),i.y=Math.min(Math.max(i.y+=v.y,0),a-i.height);else{function p(n){return n>0?1:-1}var c=u.x-i.x,k=u.y-i.y,e=this.get_p_ratio(),o=this.get_p_resizeMode()==Aurigma.GraphicsMill.ResizeMode.proportional,d=o?Math.abs(Math.round(c*e))*p(k):k;switch(this._draggedControl){case"TL":case"TR":case"BL":case"BR":i.width=c,i.height=d;break;case"T":case"B":i.height=d;break;case"L":case"R":i.width=c}r=i.x+i.width>y,f=i.x+i.width<0,r&&(i.width=y-i.x),f&&(i.width=-i.x),(r||f)&&o&&(i.height=Math.abs(Math.round(i.width*e))*p(i.height)),r=i.y+i.height>a,f=i.y+i.height<0,r&&(i.height=a-i.y),f&&(i.height=-i.y),(r||f)&&o&&(i.width=Math.abs(Math.round(i.height/e))*p(i.width)),i.width<0&&(i.x+=i.width,i.width=-i.width),i.height<0&&(i.y+=i.height,i.height=-i.height)}this.set_p_rectangle(i.round()),s=this.get_events().getHandler("rectangleChanging"),s&&s(this,Sys.EventArgs.Empty),this._update(!1),t.preventDefault&&t.preventDefault()}else h=this._hitTest(u),this._changeCursor(h),h===null&&Aurigma.GraphicsMill.Utils.Platform.IsTouchIE()&&this._panningData.initialEvent&&(b=this._panningData.initialCurrentLeft+(this._panningData.initialEvent.pageX-t.pageX),w=this._panningData.initialCurrentTop+(this._panningData.initialEvent.pageY-t.pageY),this._viewer.set_scrollingPosition({x:b,y:w}));this._prevOffset=u},_onZoomed:function(){this._update(!0)},_onWorkspaceChanged:function(){var n=this.get_p_rectangle(),i,t;n.width>=0&&n.height>=0?(i=this._viewer.get_workspaceWidth(),t=this._viewer.get_workspaceHeight(),n.x>=i||n.y>=t?this._erase():(n.width=Math.min(i-n.x,n.width),n.height=Math.min(t-n.y,n.height),this.set_p_rectangle(n.round()))):this._erase(),this._update(!0)},_saveState:function(){var t={},n;this._serializeState(t),n=Sys.Serialization.JavaScriptSerializer.serialize(t),$get(this._stateFieldId).value=n},_serializeState:function(n){n.OutlineWidth=this._outlineWidth},get_maskColor:function(){return String.format("rgb({0},{1},{2})",this._maskColorRed,this._maskColorGreen,this._maskColorBlue)},set_maskColor:function(n){var t=n.split("(")[1].split(","),u=parseInt(t[0]),r=parseInt(t[1]),i=parseInt(t[2]);if(isNaN(u)||isNaN(r)||isNaN(i)){window.console&&console.error(n+" is incorrect value");return}this._maskColorRed=u,this._maskColorGreen=r,this._maskColorBlue=i,this._viewer&&(Sys.Browser.agent===Sys.Browser.InternetExplorer&&(Sys.Browser.version<9||Sys.Browser.documentMode<9)?this._topMask.style.backgroundColor=this._leftMask.style.backgroundColor=this._bottomMask.style.backgroundColor=this._rightMask.style.backgroundColor=String.format("rgb({0},{1},{2})",this._maskColorRed,this._maskColorGreen,this._maskColorBlue):this._viewer._jquery(this._mask).css("border-color",String.format("rgba({0},{1},{2},{3})",this._maskColorRed,this._maskColorGreen,this._maskColorBlue,parseFloat(this._maskOpacity)/100)))},get_maskOpacity:function(){return this._maskOpacity},set_maskOpacity:function(n){var r,t,i;if(this._maskOpacity!=n){this._maskOpacity=n;if(this._viewer)if(Sys.Browser.agent===Sys.Browser.InternetExplorer&&(Sys.Browser.version<9||Sys.Browser.documentMode<9))for(r=[this._topMask,this._bottomMask,this._leftMask,this._rightMask],t=0;t<4;t++)i=r[t].style,i.filter="alpha(opacity="+this._maskOpacity.toString()+")",i.MozOpacity=(this._maskOpacity/100).toString(),i.opacity=(this._maskOpacity/100).toString();else this._viewer._jquery(this._mask).css("border-color",String.format("rgba({0},{1},{2},{3})",this._maskColorRed,this._maskColorGreen,this._maskColorBlue,parseFloat(n)/100))}},get_outlineWidth:function(){return this._outlineWidth},set_outlineWidth:function(n){this._outlineWidth!=n&&(this._outlineWidth=n,this._viewer&&(this._rect.style.borderWidth=n+"px",this._update(!0)))},connect:function(n){var t,e,r,i;Aurigma.GraphicsMill.RectangleController.callBaseMethod(this,"connect",[n]),t=this._getRenderCtx(),Sys.Browser.agent===Sys.Browser.InternetExplorer&&(Sys.Browser.version<9||Sys.Browser.documentMode<9)||Aurigma.GraphicsMill.Utils.Platform.IsNativeAndroidBrowser()?(t.appendChild(this._topMask=this._createIE68Mask()),t.appendChild(this._bottomMask=this._createIE68Mask()),t.appendChild(this._leftMask=this._createIE68Mask()),t.appendChild(this._rightMask=this._createIE68Mask())):t.appendChild(this._mask=this._createMask()),this._rect=this._createRect(1,1,null),this._rect.style.WebkitTransform="translate3d(0,0,0)",this._rect.style.MozTransform="translate3d(0,0,0)",t.appendChild(this._rect);var u={position:"absolute",opacity:"0.4","font-size":"0","background-color":"white","-webkit-transform":"translate3d(0,0,0)","-moz-transform":"translate3d(0,0,0)"},s={height:this.get_outlineWidth()+"px",width:"100%","background-image":"url(data:image/gif;base64,R0lGODlhCAABAPcAAP///wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP///yH5BAEAAP8ALAAAAAAIAAEAAAgJAP8J/BegYICAADs=)"},o={height:"100%",width:this.get_outlineWidth()+"px","background-image":"url(data:image/gif;base64,R0lGODlhAQAIAPcAAP///wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP///yH5BAEAAP8ALAAAAAABAAgAAAgJAP8J/BegYICAADs=)"},c={right:0},h={bottom:0},l={top:0},a={left:0},f=this._viewer._jquery(this._rect);this._viewer._jquery('<div id="top"/>').css(u).css(s).css(l).appendTo(f),this._viewer._jquery('<div id="bottom"/>').css(u).css(s).css(h).appendTo(f),this._viewer._jquery('<div id="left"/>').css(u).css(o).css(a).appendTo(f),this._viewer._jquery('<div id="right"/>').css(u).css(o).css(c).appendTo(f),e=this.get_p_resizeMode(),r=e!=Aurigma.GraphicsMill.ResizeMode.none&&this.get_p_gripsVisible(),t.appendChild(this._topLeftGrip=this._createGrip(r)),t.appendChild(this._topRightGrip=this._createGrip(r)),t.appendChild(this._bottomLeftGrip=this._createGrip(r)),t.appendChild(this._bottomRightGrip=this._createGrip(r)),i=e==Aurigma.GraphicsMill.ResizeMode.arbitrary&&this.get_p_gripsVisible(),t.appendChild(this._leftGrip=this._createGrip(i)),t.appendChild(this._rightGrip=this._createGrip(i)),t.appendChild(this._topGrip=this._createGrip(i)),t.appendChild(this._bottomGrip=this._createGrip(i)),this._jLeftGrips=this._viewer._jquery([this._topLeftGrip,this._bottomLeftGrip,this._leftGrip]),this._jTopGrips=this._viewer._jquery([this._topLeftGrip,this._topRightGrip,this._topGrip]),this._jRightGrips=this._viewer._jquery([this._bottomRightGrip,this._topRightGrip,this._rightGrip]),this._jBottomGrips=this._viewer._jquery([this._bottomRightGrip,this._bottomLeftGrip,this._bottomGrip]),this._jVertCenterGrips=this._viewer._jquery([this._bottomGrip,this._topGrip]),this._jHorizCenterGrips=this._viewer._jquery([this._rightGrip,this._leftGrip]),this._update(!0),this._workspaceChangedDelegate=Function.createDelegate(this,this._onWorkspaceChanged),this._viewer.add_workspaceChanged(this._workspaceChangedDelegate),this._workspaceMouseDownDelegate=Function.createDelegate(this,this._onWorkspaceMouseDown),this._viewer.add_workspaceMouseDown(this._workspaceMouseDownDelegate),this._workspaceMouseMoveDelegate=Function.createDelegate(this,this._onWorkspaceMouseMove),this._viewer.add_workspaceMouseMove(this._workspaceMouseMoveDelegate),this._workspaceMouseUpDelegate=Function.createDelegate(this,this._onWorkspaceMouseUp),this._viewer.add_workspaceMouseUp(this._workspaceMouseUpDelegate),this._zoomedDelegate=Function.createDelegate(this,this._onZoomed),this._viewer.add_zoomed(this._zoomedDelegate)},disconnect:function(){this._viewer&&(this._viewer.clearRenderCtx(this._getRenderCtx()),this._topMask=this._bottomMask=this._leftMask=this._rightMask=null,this._rect=null,this._topLeftGrip=this._topRightGrip=this._bottomLeftGrip=this._bottomRightGrip=this._leftGrip=this._rightGrip=this._topGrip=this._bottomGrip=null,this._jLeftGrips=this._jTopGrips=this._jRightGrips=this._jBottomGrips=this._jVertCenterGrips=this._jHorizCenterGrips=null,this._viewer.remove_workspaceChanged(this._workspaceChangedDelegate),this._viewer.remove_workspaceMouseDown(this._workspaceMouseDownDelegate),this._viewer.remove_workspaceMouseMove(this._workspaceMouseMoveDelegate),this._viewer.remove_workspaceMouseUp(this._workspaceMouseUpDelegate),this._viewer.remove_zoomed(this._zoomedDelegate)),Aurigma.GraphicsMill.RectangleController.callBaseMethod(this,"disconnect")}},Aurigma.GraphicsMill.RectangleController.registerClass("Aurigma.GraphicsMill.RectangleController",Aurigma.GraphicsMill.UserInputController),Aurigma.GraphicsMill.RectangleRubberband=function(n){Aurigma.GraphicsMill.RectangleRubberband.initializeBase(this,[n]),this._autoPostBack=!1,this._erasable=!0,this._gripSize=9,this._touchHideGripSize=33,this._gripsVisible=!1,this._maskVisible=!1,this._movable=!0,this._ratio=1,this._rectangle=new Aurigma.GraphicsMill.Rectangle(0,0,-1,-1),this._resizeMode=Aurigma.GraphicsMill.ResizeMode.arbitrary,this._rectangleChangedPostBack=null,this._rectangleChanged=!1,this._panningData={initialEvent:null}},Aurigma.GraphicsMill.RectangleRubberband.prototype={get_p_autoPostBack:function(){return this._autoPostBack},set_p_autoPostBack:function(n){this._autoPostBack=n},get_p_erasable:function(){return this._erasable},set_p_erasable:function(n){this._erasable=n},get_p_gripSize:function(){return this._gripSize},set_p_gripSize:function(n){this._gripSize=n},get_p_touchHideGripSize:function(){return this._touchHideGripSize},set_p_touchHideGripSize:function(n){this._touchHideGripSize=n},get_p_gripsVisible:function(){return this._gripsVisible},set_p_gripsVisible:function(n){this._gripsVisible=n},get_p_maskVisible:function(){return this._maskVisible},set_p_maskVisible:function(n){this._maskVisible=n},get_p_movable:function(){return this._movable},set_p_movable:function(n){this._movable=n},get_p_ratio:function(){return this._ratio},set_p_ratio:function(n){this._ratio=n},get_p_rectangle:function(){return this._rectangle.clone()},set_p_rectangle:function(n){this._rectangle=n.clone()},get_p_resizeMode:function(){return this._resizeMode},set_p_resizeMode:function(n){this._resizeMode=n},_onWorkspaceMouseUp:function(n,t){var r,i;this._panningData.initialEvent=null;if(!this._handleInput)return;this._viewer.get_contentCtx().releaseCapture&&this._viewer.get_contentCtx().releaseCapture(),this._draggedControl&&(this._draggedControl=null,r=this._hitTest(new Aurigma.GraphicsMill.PointF(t.x,t.y)),this._changeCursor(r),i=this.get_events().getHandler("rectangleChanged"),i&&i(this,Sys.EventArgs.Empty),this._update(!0),this.get_p_autoPostBack()?this._rectangleChangedPostBack():this._rectangleChanged=!0)},_getRenderCtx:function(){return this._viewer.get_rubberbandCtx()},_serializeState:function(n){Aurigma.GraphicsMill.RectangleRubberband.callBaseMethod(this,"_serializeState",[n]),n.AutoPostBack=this._autoPostBack,n.Erasable=this._erasable,n.GripSize=this._gripSize,n.GripsVisible=this._gripsVisible,n.MaskVisible=this._maskVisible,n.MaskOpacity=this._maskOpacity,n.MaskColor=this._maskColor,n.Movable=this._movable,n.Ratio=this._ratio,n.Rectangle=this._rectangle,n.ResizeMode=this._resizeMode,n.RectangleChanged=this._rectangleChanged},get_autoPostBack:function(){return this.get_p_autoPostBack()},set_autoPostBack:function(n){this.set_p_autoPostBack(n)},get_erasable:function(){return this.get_p_erasable()},set_erasable:function(n){this.set_p_erasable(n)},get_gripSize:function(){return this.get_p_gripSize()},set_gripSize:function(n){n!=this.get_p_gripSize()&&(this.set_p_gripSize(n),this._update(!0))},get_gripsVisible:function(){return this.get_p_gripsVisible()},set_gripsVisible:function(n){n!=this.get_p_gripsVisible()&&(this.set_p_gripsVisible(n),this._update(!0))},get_maskVisible:function(){return this.get_p_maskVisible()},set_maskVisible:function(n){n!=this.get_p_maskVisible()&&(this.set_p_maskVisible(n),this._update(!0))},get_movable:function(){return this.get_p_movable()},set_movable:function(n){this.set_p_movable(n)},get_ratio:function(){return this.get_p_ratio()},set_ratio:function(n){this.set_p_ratio(n)},get_rectangle:function(){return this.get_p_rectangle()},set_rectangle:function(n){n.equals(this.get_p_rectangle)||(this.set_p_rectangle(n),this._update(!0))},get_resizeMode:function(){return this.get_p_resizeMode()},set_resizeMode:function(n){n!=this.get_p_resizeMode()&&(this.set_p_resizeMode(n),this._update(!0))},connect:function(n){Aurigma.GraphicsMill.RectangleRubberband.callBaseMethod(this,"connect",[n]),this.update()},erase:function(){this.get_p_erasable()&&(this._erase(),this._update(!0))},update:function(){this._handleInput=this._viewer.get_navigator()=="",this._update(!0)},add_rectangleChanged:function(n){this.get_events().addHandler("rectangleChanged",n)},remove_rectangleChanged:function(n){this.get_events().removeHandler("rectangleChanged",n)},add_rectangleChanging:function(n){this.get_events().addHandler("rectangleChanging",n)},remove_rectangleChanging:function(n){this.get_events().removeHandler("rectangleChanging",n)}},Aurigma.GraphicsMill.RectangleRubberband.registerClass("Aurigma.GraphicsMill.RectangleRubberband",Aurigma.GraphicsMill.RectangleController),Aurigma.GraphicsMill.ZoomRectangleNavigator=function(n){Aurigma.GraphicsMill.ZoomRectangleNavigator.initializeBase(this,[n]),this._ratio=1,this._rectangle=new Aurigma.GraphicsMill.Rectangle(0,0,-1,-1)},Aurigma.GraphicsMill.ZoomRectangleNavigator.prototype={get_p_autoPostBack:function(){return!1},get_p_erasable:function(){return!0},get_p_gripSize:function(){return 0},get_p_gripsVisible:function(){return!1},get_p_maskVisible:function(){return!1},get_p_movable:function(){return!1},get_p_ratio:function(){return this._ratio},get_p_rectangle:function(){return this._rectangle.clone()},set_p_ratio:function(n){this._ratio=n},set_p_rectangle:function(n){this._rectangle=n.clone()},get_p_resizeMode:function(){return Aurigma.GraphicsMill.ResizeMode.proportional},_getRenderCtx:function(){return this._viewer.get_navigatorCtx()},_onWorkspaceMouseUp:function(){var i,r,u,f;if(this._draggedControl){this._draggedControl=null,this._viewer.set_cursor(Aurigma.GraphicsMill.Cursor.defaultCursor),i=this.get_p_rectangle(),this._erase();var e=this._viewer.get_width(),o=this._viewer.get_height(),s=e/i.width;this._viewer.set_zoom(s,{skipZoomToCenter:!0}),r=this._viewer.get_zoom(),u=parseInt((e-i.width*r)/2),u=Math.round(i.x*r)-u<0?0:Math.round(i.x*r)-u,f=parseInt((o-i.height*r)/2),f=Math.round(i.y*r)-f<0?0:Math.round(i.y*r)-f,this._viewer.set_scrollingPosition(new Sys.UI.Point(u,f)),this._viewer.get_contentCtx().releaseCapture&&this._viewer.get_contentCtx().releaseCapture()}},_saveState:function(){var n=Sys.Serialization.JavaScriptSerializer.serialize({OutlineWidth:this._outlineWidth});$get(this._stateFieldId).value=n},connect:function(n){Aurigma.GraphicsMill.ZoomRectangleNavigator.callBaseMethod(this,"connect",[n]);var t=this._viewer.workspaceToControlRectangle(new Aurigma.GraphicsMill.Rectangle(0,0,this._viewer.get_width(),this._viewer.get_height()));this._ratio=t.height/t.width}},Aurigma.GraphicsMill.ZoomRectangleNavigator.registerClass("Aurigma.GraphicsMill.ZoomRectangleNavigator",Aurigma.GraphicsMill.RectangleController),typeof Sys!="undefined"&&Sys.Application.notifyScriptLoaded();